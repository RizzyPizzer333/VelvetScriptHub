<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ScriptBlox Hub</title>

<style>
    body {
        background:#111;
        color:#eee;
        font-family:Arial, sans-serif;
        padding:20px;
    }

    h2 {
        margin-bottom:10px;
    }

    /* Filters */
    .filters {
        display:flex;
        gap:10px;
        margin-bottom:10px;
    }
    .filter-btn {
        padding:8px 14px;
        background:#222;
        border:1px solid #444;
        border-radius:6px;
        cursor:pointer;
    }
    .filter-btn:hover {
        background:#333;
    }

    /* Script list container */
    #scriptList {
        height:450px;
        overflow-y:auto;
        background:#1a1a1a;
        padding:10px;
        border-radius:8px;
        border:1px solid #333;
    }

    /* Custom scrollbar */
    #scriptList::-webkit-scrollbar {
        width:8px;
    }
    #scriptList::-webkit-scrollbar-track {
        background:#1f1f1f;
    }
    #scriptList::-webkit-scrollbar-thumb {
        background:#555;
        border-radius:10px;
    }

    /* Script card */
    .card {
        background:#222;
        border-radius:6px;
        padding:10px;
        margin-bottom:10px;
        border:1px solid #333;
        cursor:pointer;
        transition:0.2s;
    }
    .card:hover {
        background:#2a2a2a;
    }

    /* Copy toast */
    #toast {
        position:fixed;
        bottom:25px;
        right:25px;
        background:#222;
        padding:10px 16px;
        border-radius:5px;
        border:1px solid #555;
        display:none;
    }
</style>
</head>

<body>

<h2>ScriptBlox Script Hub</h2>

<div class="filters">
    <button class="filter-btn" data-filter="all">All</button>
    <button class="filter-btn" data-filter="popular">Popular</button>
    <button class="filter-btn" data-filter="roblox">Roblox</button>
</div>

<div id="scriptList"></div>

<div id="toast">Copied!</div>

<script>
    /* --- API CONFIG --- */
    const API_FETCH = "https://scriptblox.com/api/script/fetch?page=";
    const API_RAW  = "https://scriptblox.com/api/script/raw/";

    /* --- STATE --- */
    let page = 1;
    let loading = false;
    let filterMode = "all";
    let reachedEnd = false;

    const list = document.getElementById("scriptList");
    const toast = document.getElementById("toast");

    /* --- LOAD SCRIPTS --- */
    async function loadScripts() {
        if (loading || reachedEnd) return;
        loading = true;

        try {
            const res = await fetch(API_FETCH + page);
            const data = await res.json();

            if (!data || !data.result || data.result.scripts.length === 0) {
                reachedEnd = true;
                return;
            }

            const scripts = data.result.scripts;

            scripts.forEach(script => {
                if (filterMode !== "all" && script.game?.type !== filterMode) return;

                const div = document.createElement("div");
                div.className = "card";
                div.innerHTML = `
                    <b>${script.title}</b><br>
                    <small>${script.game?.name || "Unknown Game"}</small>
                `;

                div.onclick = () => copyScript(script.id);
                list.appendChild(div);
            });

            page++;
        } catch {
            console.log("API error");
        }

        loading = false;
    }

    /* --- COPY RAW SCRIPT --- */
    async function copyScript(id) {
        try {
            const res = await fetch(API_RAW + id);
            const data = await res.json();

            await navigator.clipboard.writeText(data.result.script);
            showToast("Copied Script!");
        } catch {
            showToast("Copy failed!");
        }
    }

    /* --- Toast --- */
    function showToast(msg) {
        toast.innerText = msg;
        toast.style.display = "block";
        setTimeout(() => toast.style.display = "none", 1500);
    }

    /* --- Scroll listener (infinite load) --- */
    list.addEventListener("scroll", () => {
        if (list.scrollTop + list.clientHeight >= list.scrollHeight - 20) {
            loadScripts();
        }
    });

    /* --- Filters --- */
    document.querySelectorAll(".filter-btn").forEach(btn => {
        btn.addEventListener("click", () => {
            filterMode = btn.dataset.filter;
            list.innerHTML = "";
            page = 1;
            reachedEnd = false;
            loadScripts();
        });
    });

    /* Initial load */
    loadScripts();
</script>

</body>
</html>
